---
title: "Likelihood and Gradient"
format: html
---

The posterior probability is the some of likelihood $L$ and prior $P$.

The number of components is $l+1$.

Let's write $u_j$ with $j=0,\dots,l-1$ for the $l$-dimensional MC sample that is given to the callback fucntion.

From this, we get the $(l+1)$-dimensional simplex coordinates $\pi_r$ with $r=0,\dots,l$ as follows:

$$\begin{align}\pi_0&=(1-u_0)\\ \pi_1&=u_0(1-u_1)\\ \pi_2&=u_0u_1(1-u_2)\\ \pi_3&=u_0u_1u_2(1-u_3)\\&...\\ 
\pi_{l-1}&=u_0u_1\dots u_{l-2}(1-u_{l-1}) \\ \pi_l&=u_0u_1\dots u_{l-2}u_{l-1} \end{align}.$$

These simplex coordinates are drawn uniformly from the simplex if the $u_j$ where drawn as
$$ \begin{align}
u_{0} &\sim \text{Be}(l,1) \\ 
u_{1} &\sim \text{Be}(l-1,1) \\ 
&\dots \\
u_{l-2} &\sim \text{Be}(2,1) \\ 
u_{l-1} &\sim \text{Be}(1,1) = \text{Unif}(0,1)
\end{align}$$


The log pdf of these Beta distributions are
$$ \log f_\text{Be}(u|a,b)=\log\frac{u^{a-1}(1-u)^{b-1}}{B(a,b)}=\log au^{a-1}=\log a + (a-1)\log u
$$

